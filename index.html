<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Juego de Crucigramas con Modificaciones</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Código CSS integrado -->
    <style>
        /* Estilos Generales */
        body {
            background-color: #f0f8ff;
            font-family: Arial, sans-serif;
            margin: 0;
        }

        .container {
            width: 90%;
            max-width: 600px;
            margin: 20px auto;
            text-align: center;
            background-color: #fff;
            padding: 20px 15px;
            border-radius: 10px;
            box-sizing: border-box;
            overflow: hidden;
        }

        h1, h2, h3 {
            color: #333;
            margin: 10px 0;
        }

        /* Botones Generales */
        .btn {
            padding: 15px 30px;
            margin: 10px;
            font-size: 1em;
            cursor: pointer;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 5px;
        }

        .btn:hover {
            background-color: #0056b3;
        }

        /* Contenedor del Juego */
        #definition {
            font-size: 1.2em;
            margin: 20px 0;
        }

        .input-group {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }

        #answer {
            padding: 10px;
            width: 60%;
            max-width: 300px;
            font-size: 1em;
            margin-bottom: 10px;
        }

        #submit {
            padding: 10px 20px;
            font-size: 1em;
            cursor: pointer;
            background-color: #28a745;
            color: #fff;
            border: none;
            border-radius: 5px;
            margin-left: 10px;
        }

        #submit:hover {
            background-color: #218838;
        }

        #message {
            margin-top: 20px;
            font-size: 1.1em;
            color: #d9534f;
        }

        #attempts, #score {
            font-size: 1.1em;
            margin-top: 10px;
        }

        /* Botón Volver al Menú */
        #back-to-main {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 1em;
            cursor: pointer;
            background-color: #dc3545;
            color: #fff;
            border: none;
            border-radius: 5px;
        }

        #back-to-main:hover {
            background-color: #c82333;
        }

        /* Mensaje de Victoria */
        #win-message h1 {
            font-size: 2.5em;
            color: #28a745;
        }

        #restart {
            padding: 10px 20px;
            font-size: 1em;
            cursor: pointer;
            background-color: #17a2b8;
            color: #fff;
            border: none;
            border-radius: 5px;
        }

        #restart:hover {
            background-color: #117a8b;
        }

        /* Tienda de Avatares y Pokémon */
        .store {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }

        .store-item {
            margin: 10px;
            text-align: center;
        }

        .store-item img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
        }

        .store-item button {
            margin-top: 5px;
            padding: 5px 10px;
            font-size: 0.9em;
            cursor: pointer;
            background-color: #ffc107;
            color: #212529;
            border: none;
            border-radius: 5px;
        }

        .store-item button:hover {
            background-color: #e0a800;
        }

        /* Pokédex */
        #pokedex-icon {
            width: 50px;
            cursor: pointer;
            margin: 10px;
        }

        .pokedex-entry {
            display: flex;
            align-items: center;
            margin: 5px 0;
        }

        .pokedex-entry img {
            width: 50px;
            height: 50px;
            margin-right: 10px;
        }

        /* Selección de Avatar */
        #current-avatar-container {
            margin-top: 20px;
            text-align: center;
        }

        #current-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            display: block;
            margin: 10px auto;
        }

        @media (max-width: 600px) {
            .btn {
                width: 100%;
                margin: 10px 0;
            }

            #submit {
                width: 100%;
                margin-left: 0;
            }

            #answer {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Menú Principal -->
    <div class="container" id="main-menu">
        <h1>Juego de Crucigramas</h1>
        <h2>Selecciona el modo de juego</h2>
        <button class="btn" id="normal-mode">Modo Normal</button>
        <button class="btn" id="pokemon-mode">Modo Pokémon</button>
        <div id="current-avatar-container">
            <h3>Puntos acumulados: <span id="total-score">0</span></h3>
            <h3>Avatar Actual:</h3>
            <img id="current-avatar" src="" alt="Avatar Actual">
            <button id="change-avatar">Cambiar Avatar</button>
            <button id="open-pokemon-store">Tienda Pokémon</button>
        </div>
    </div>

    <!-- Selección de Dificultad -->
    <div class="container" id="difficulty-selection" style="display: none;">
        <h1>Modo Normal</h1>
        <h2>Selecciona la dificultad</h2>
        <button class="btn difficulty-btn" data-level="facil">Fácil</button>
        <button class="btn difficulty-btn" data-level="normal">Normal</button>
        <button class="btn difficulty-btn" data-level="experto">Difícil</button>
    </div>

    <!-- Contenedor del Juego -->
    <div class="container" id="game-container" style="display: none;">
        <h1 id="game-title">Juego de Crucigramas</h1>
        <div id="score">Puntuación de la Partida: 0</div>
        <div id="definition"></div>
        <div class="input-group">
            <input type="text" id="answer" placeholder="Escribe tu respuesta aquí">
            <button id="submit">Enviar</button>
        </div>
        <div id="attempts">Intentos restantes: 3</div>
        <div id="message"></div>
        <button id="back-to-main">Volver al Menú</button>
    </div>

    <!-- Mensaje de Victoria -->
    <div class="container" id="win-message" style="display: none;">
        <h1>¡HAS GANADO!</h1>
        <button id="restart">Volver al Menú Principal</button>
    </div>

    <!-- Tienda de Avatares -->
    <div class="container" id="avatar-store" style="display: none;">
        <h1>Tienda de Avatares</h1>
        <h3>Tus Puntos: <span id="store-total-score">0</span></h3>
        <div class="store">
            <!-- Los avatares se generarán dinámicamente -->
        </div>
        <button id="back-to-menu">Volver al Menú</button>
    </div>

    <!-- Tienda de Pokémon -->
    <div class="container" id="pokemon-store" style="display: none;">
        <h1>Tienda de Pokémon</h1>
        <h3>Puntos Pokémon: <span id="pokemon-points">0</span></h3>
        <img id="pokedex-icon" src="https://i.imgur.com/uwBWJ0u.png" alt="Pokédex">
        <div class="store">
            <!-- Los Pokémon se mostrarán aquí -->
        </div>
        <button id="back-to-menu-pokemon">Volver al Menú</button>
    </div>

    <!-- Pokédex -->
    <div class="container" id="pokedex" style="display: none;">
        <h1>Pokédex</h1>
        <div id="pokedex-entries">
            <!-- Entradas de la Pokédex -->
        </div>
        <button id="close-pokedex">Cerrar Pokédex</button>
    </div>

    <!-- Código JavaScript integrado -->
    <script>
        // Variables Globales
        let totalScore = 0;
        let gameScore = 0;
        let attempts = 3;
        let currentWord = '';
        let currentDefinition = '';
        let difficulty = '';
        let filteredWords = [];
        let currentAvatar = '';
        let pokemonPoints = 0;
        let capturedPokemon = [];

        // Datos de Avatares
        let avatars = [
            { id: 1, src: 'https://i.pravatar.cc/100?img=1', price: 10, unlocked: false },
            { id: 2, src: 'https://i.pravatar.cc/100?img=2', price: 20, unlocked: false },
            { id: 3, src: 'https://i.pravatar.cc/100?img=3', price: 30, unlocked: false },
            { id: 4, src: 'https://i.pravatar.cc/100?img=4', price: 40, unlocked: false },
            { id: 5, src: 'https://i.pravatar.cc/100?img=5', price: 50, unlocked: false },
        ];

        // Palabras para el Modo Normal
        const words = [
            // Palabras de Dificultad Fácil
            { word: 'perro', definition: 'Animal doméstico conocido como el mejor amigo del hombre.', difficulty: 'facil' },
            { word: 'gato', definition: 'Animal doméstico que le gusta dormir y cazar ratones.', difficulty: 'facil' },
            { word: 'sol', definition: 'Estrella luminosa que es el centro de nuestro sistema solar.', difficulty: 'facil' },
            { word: 'casa', definition: 'Lugar donde habita una familia.', difficulty: 'facil' },
            { word: 'libro', definition: 'Conjunto de hojas encuadernadas que contienen texto o imágenes.', difficulty: 'facil' },
            // Palabras de Dificultad Normal
            { word: 'computadora', definition: 'Dispositivo electrónico usado para procesar datos.', difficulty: 'normal' },
            { word: 'bicicleta', definition: 'Vehículo de dos ruedas impulsado por pedales.', difficulty: 'normal' },
            { word: 'astronomía', definition: 'Ciencia que estudia los cuerpos celestes.', difficulty: 'normal' },
            { word: 'montaña', definition: 'Gran elevación natural del terreno.', difficulty: 'normal' },
            { word: 'electricidad', definition: 'Forma de energía resultante de la existencia de una diferencia de potencial.', difficulty: 'normal' },
            // Palabras de Dificultad Difícil
            { word: 'criptografía', definition: 'Ciencia de escribir con clave secreta o de un modo enigmático.', difficulty: 'experto' },
            { word: 'paralelepípedo', definition: 'Sólido de seis caras paralelas e iguales dos a dos.', difficulty: 'experto' },
            { word: 'electroencefalograma', definition: 'Registro gráfico de la actividad eléctrica del cerebro.', difficulty: 'experto' },
            { word: 'esternocleidomastoideo', definition: 'Músculo del cuello que permite la rotación y flexión de la cabeza.', difficulty: 'experto' },
            { word: 'otorrinolaringología', definition: 'Especialidad médica que se encarga de las enfermedades del oído, nariz y garganta.', difficulty: 'experto' },
            // Puedes agregar más palabras y definiciones aquí clasificadas por dificultad
        ];

        // Palabras para el Modo Pokémon
        const pokemonWords = [
            { word: 'pikachu', definition: 'Pokémon de tipo eléctrico conocido por ser el compañero de Ash.', difficulty: 'pokemon' },
            { word: 'bulbasaur', definition: 'Pokémon inicial de tipo planta en la región de Kanto.', difficulty: 'pokemon' },
            { word: 'charmander', definition: 'Pokémon inicial de tipo fuego en la región de Kanto.', difficulty: 'pokemon' },
            { word: 'squirtle', definition: 'Pokémon inicial de tipo agua en la región de Kanto.', difficulty: 'pokemon' },
            { word: 'mewtwo', definition: 'Pokémon legendario creado a partir del ADN de Mew.', difficulty: 'pokemon' },
            // Puedes agregar más Pokémon aquí
        ];

        // Elementos del DOM
        const mainMenu = document.getElementById('main-menu');
        const normalModeBtn = document.getElementById('normal-mode');
        const pokemonModeBtn = document.getElementById('pokemon-mode');
        const difficultyButtons = document.querySelectorAll('.difficulty-btn');
        const gameContainer = document.getElementById('game-container');
        const difficultySelection = document.getElementById('difficulty-selection');
        const winMessage = document.getElementById('win-message');
        const restartButton = document.getElementById('restart');
        const totalScoreSpan = document.getElementById('total-score');
        const storeTotalScoreSpan = document.getElementById('store-total-score');
        const currentAvatarImg = document.getElementById('current-avatar');
        const changeAvatarButton = document.getElementById('change-avatar');
        const avatarStore = document.getElementById('avatar-store');
        const avatarStoreContainer = document.querySelector('#avatar-store .store');
        const backToMenuButton = document.getElementById('back-to-menu');
        const gameTitle = document.getElementById('game-title');
        const pokemonStore = document.getElementById('pokemon-store');
        const pokemonStoreContainer = document.querySelector('#pokemon-store .store');
        const backToMenuPokemonButton = document.getElementById('back-to-menu-pokemon');
        const pokemonPointsSpan = document.getElementById('pokemon-points');
        const openPokemonStoreBtn = document.getElementById('open-pokemon-store');
        const pokedexIcon = document.getElementById('pokedex-icon');
        const pokedex = document.getElementById('pokedex');
        const pokedexEntries = document.getElementById('pokedex-entries');
        const closePokedexButton = document.getElementById('close-pokedex');
        const backToMainButton = document.getElementById('back-to-main');

        // Funciones de Guardado y Carga
        function saveGame() {
            const gameData = {
                totalScore,
                currentAvatar,
                avatars,
                pokemonPoints,
                capturedPokemon
            };
            localStorage.setItem('gameData', JSON.stringify(gameData));
        }

        function loadGame() {
            const savedData = JSON.parse(localStorage.getItem('gameData'));
            if (savedData) {
                totalScore = savedData.totalScore;
                currentAvatar = savedData.currentAvatar;
                avatars = savedData.avatars;
                pokemonPoints = savedData.pokemonPoints || 0;
                capturedPokemon = savedData.capturedPokemon || [];
            }
        }

        // Funciones Generales
        function updateTotalScore() {
            totalScoreSpan.innerText = totalScore;
            storeTotalScoreSpan.innerText = totalScore;
            pokemonPointsSpan.innerText = pokemonPoints;
            saveGame();
        }

        function updateAvatar() {
            if (currentAvatar) {
                currentAvatarImg.src = currentAvatar;
            } else {
                currentAvatarImg.src = 'https://i.pravatar.cc/100?img=0'; // Avatar por defecto
            }
            saveGame();
        }

        function openAvatarStore() {
            mainMenu.style.display = 'none';
            avatarStore.style.display = 'block';
            renderAvatars();
        }

        function renderAvatars() {
            avatarStoreContainer.innerHTML = '';
            avatars.forEach(avatar => {
                const avatarDiv = document.createElement('div');
                avatarDiv.classList.add('store-item');

                const avatarImg = document.createElement('img');
                avatarImg.src = avatar.src;
                avatarDiv.appendChild(avatarImg);

                const avatarButton = document.createElement('button');
                if (avatar.unlocked) {
                    avatarButton.innerText = 'Seleccionar';
                    avatarButton.onclick = function() {
                        currentAvatar = avatar.src;
                        updateAvatar();
                        alert('Has cambiado tu avatar.');
                    };
                } else {
                    avatarButton.innerText = 'Comprar (' + avatar.price + ' pts)';
                    avatarButton.onclick = function() {
                        if (totalScore >= avatar.price) {
                            totalScore -= avatar.price;
                            updateTotalScore();
                            avatar.unlocked = true;
                            avatarButton.innerText = 'Seleccionar';
                            avatarButton.onclick = function() {
                                currentAvatar = avatar.src;
                                updateAvatar();
                                alert('Has cambiado tu avatar.');
                            };
                            alert('Has comprado un nuevo avatar.');
                        } else {
                            alert('No tienes suficientes puntos.');
                        }
                    };
                }
                avatarDiv.appendChild(avatarButton);
                avatarStoreContainer.appendChild(avatarDiv);
            });
        }

        function openPokemonStore() {
            mainMenu.style.display = 'none';
            pokemonStore.style.display = 'block';
            renderPokemonStore();
        }

        function renderPokemonStore() {
            pokemonStoreContainer.innerHTML = '';
            const pokemonButton = document.createElement('button');
            pokemonButton.innerText = 'Comprar Pokémon Aleatorio (10 pts)';
            pokemonButton.onclick = function() {
                if (pokemonPoints >= 10) {
                    pokemonPoints -= 10;
                    updateTotalScore();
                    const randomPokemon = pokemonWords[Math.floor(Math.random() * pokemonWords.length)];
                    if (!capturedPokemon.includes(randomPokemon.word)) {
                        capturedPokemon.push(randomPokemon.word);
                        alert('¡Has capturado a ' + capitalizeFirstLetter(randomPokemon.word) + '!');
                    } else {
                        alert('Ya tienes a ' + capitalizeFirstLetter(randomPokemon.word) + '.');
                    }
                    saveGame();
                    renderPokemonStore();
                } else {
                    alert('No tienes suficientes puntos Pokémon.');
                }
            };
            pokemonStoreContainer.appendChild(pokemonButton);
        }

        function openPokedex() {
            pokedex.style.display = 'block';
            pokemonStore.style.display = 'none';
            renderPokedex();
        }

        function renderPokedex() {
            pokedexEntries.innerHTML = '';
            if (capturedPokemon.length > 0) {
                capturedPokemon.forEach(pokemonName => {
                    const pokedexEntry = document.createElement('div');
                    pokedexEntry.classList.add('pokedex-entry');

                    const pokemonImg = document.createElement('img');
                    pokemonImg.src = `https://img.pokemondb.net/artwork/large/${pokemonName}.jpg`;
                    pokemonImg.onerror = function() {
                        pokemonImg.src = 'https://via.placeholder.com/50';
                    };

                    const pokemonText = document.createElement('span');
                    pokemonText.innerText = capitalizeFirstLetter(pokemonName);

                    pokedexEntry.appendChild(pokemonImg);
                    pokedexEntry.appendChild(pokemonText);
                    pokedexEntries.appendChild(pokedexEntry);
                });
            } else {
                pokedexEntries.innerHTML = '<p>No has capturado ningún Pokémon aún.</p>';
            }
        }

        function capitalizeFirstLetter(string) {
            return string.charAt(0).toUpperCase() + string.slice(1);
        }

        // Funciones del Juego
        function getRandomWord() {
            const randomIndex = Math.floor(Math.random() * filteredWords.length);
            return filteredWords[randomIndex];
        }

        function setNewWord() {
            if (filteredWords.length === 0) {
                document.getElementById('message').innerText = 'No hay más palabras en este modo.';
                return;
            }
            const wordObj = getRandomWord();
            currentWord = wordObj.word.toLowerCase();
            currentDefinition = wordObj.definition;
            document.getElementById('definition').innerText = currentDefinition;
            document.getElementById('answer').value = '';
            document.getElementById('message').innerText = '';
            attempts = 3;
            document.getElementById('attempts').innerText = 'Intentos restantes: ' + attempts;
        }

        function startGame(selectedDifficulty) {
            difficulty = selectedDifficulty;
            if (difficulty === 'pokemon') {
                filteredWords = [...pokemonWords];
                gameTitle.innerText = 'Modo Pokémon';
            } else {
                filteredWords = words.filter(word => word.difficulty === difficulty);
                gameTitle.innerText = 'Modo Normal';
            }
            gameScore = 0;
            document.getElementById('score').innerText = 'Puntuación de la Partida: ' + gameScore;
            mainMenu.style.display = 'none';
            difficultySelection.style.display = 'none';
            winMessage.style.display = 'none';
            avatarStore.style.display = 'none';
            pokemonStore.style.display = 'none';
            pokedex.style.display = 'none';
            gameContainer.style.display = 'block';
            setNewWord();
        }

        function checkWin() {
            let winScore = 0;
            if (difficulty === 'pokemon') {
                winScore = 10; // Puedes ajustar este valor
                if (gameScore >= winScore) {
                    pokemonPoints += gameScore;
                    updateTotalScore();
                    gameScore = 0; // Reiniciar gameScore
                    gameContainer.style.display = 'none';
                    winMessage.style.display = 'block';
                }
            } else {
                switch(difficulty) {
                    case 'facil':
                        winScore = 15;
                        break;
                    case 'normal':
                        winScore = 30;
                        break;
                    case 'experto':
                        winScore = 45;
                        break;
                }
                if (gameScore >= winScore) {
                    totalScore += gameScore;
                    updateTotalScore();
                    gameScore = 0; // Reiniciar gameScore
                    gameContainer.style.display = 'none';
                    winMessage.style.display = 'block';
                }
            }
        }

        // Eventos
        normalModeBtn.addEventListener('click', function() {
            mainMenu.style.display = 'none';
            difficultySelection.style.display = 'block';
        });

        pokemonModeBtn.addEventListener('click', function() {
            startGame('pokemon');
        });

        difficultyButtons.forEach(button => {
            button.addEventListener('click', function() {
                startGame(this.getAttribute('data-level'));
            });
        });

        document.getElementById('submit').addEventListener('click', function() {
            const userAnswer = document.getElementById('answer').value.toLowerCase().trim();
            if (userAnswer === '') {
                document.getElementById('message').innerText = 'Por favor, ingresa una respuesta.';
                return;
            }
            if (userAnswer === currentWord) {
                // Respuesta correcta
                let pointsEarned = 0;
                if (difficulty === 'pokemon') {
                    pointsEarned = 1; // Puedes ajustar este valor
                    gameScore += pointsEarned;
                    document.getElementById('score').innerText = 'Puntos Pokémon Ganados: ' + gameScore;
                    document.getElementById('message').innerText = '¡Correcto! Has ganado ' + pointsEarned + ' punto(s) Pokémon.';
                } else {
                    switch(difficulty) {
                        case 'facil':
                            pointsEarned = 1;
                            break;
                        case 'normal':
                            pointsEarned = 2;
                            break;
                        case 'experto':
                            pointsEarned = 3;
                            break;
                    }
                    gameScore += pointsEarned;
                    document.getElementById('score').innerText = 'Puntuación de la Partida: ' + gameScore;
                    document.getElementById('message').innerText = '¡Correcto! Has ganado ' + pointsEarned + ' punto(s).';
                }
                checkWin();
                setTimeout(setNewWord, 2000);
            } else {
                // Respuesta incorrecta
                attempts--;
                if (attempts > 0) {
                    document.getElementById('attempts').innerText = 'Intentos restantes: ' + attempts;
                    document.getElementById('message').innerText = 'Incorrecto. Inténtalo de nuevo.';
                } else {
                    // Restar 1 punto después de agotar los intentos
                    if (difficulty === 'pokemon') {
                        if (gameScore > 0) {
                            gameScore -= 1;
                        }
                        pokemonPoints = pokemonPoints > 0 ? pokemonPoints - 1 : 0;
                        document.getElementById('score').innerText = 'Puntos Pokémon Ganados: ' + gameScore;
                    } else {
                        if (gameScore > 0) {
                            gameScore -= 1;
                        }
                        totalScore = totalScore > 0 ? totalScore - 1 : 0;
                        document.getElementById('score').innerText = 'Puntuación de la Partida: ' + gameScore;
                    }
                    updateTotalScore();
                    document.getElementById('message').innerText = 'Incorrecto. Has perdido 1 punto. Pasando a la siguiente palabra.';
                    setTimeout(setNewWord, 2000);
                }
            }
        });

        // Modificación en el evento del botón "Volver al Menú"
        backToMainButton.addEventListener('click', function() {
            let confirmExit = confirm('¿Estás seguro de que quieres volver al menú? Perderás cinco puntos');
            if (confirmExit) {
                // Sumar puntos acumulados en la partida al total
                if (difficulty === 'pokemon') {
                    pokemonPoints += gameScore;
                    // Restar 5 puntos
                    pokemonPoints = pokemonPoints >= 5 ? pokemonPoints - 5 : 0;
                } else {
                    totalScore += gameScore;
                    // Restar 5 puntos
                    totalScore = totalScore >= 5 ? totalScore - 5 : 0;
                }
                gameScore = 0; // Reiniciar gameScore
                updateTotalScore();
                saveGame();
                gameContainer.style.display = 'none';
                mainMenu.style.display = 'block';
            }
            // Si cancela, no hacemos nada y permanece en el juego
        });

        restartButton.addEventListener('click', function() {
            mainMenu.style.display = 'block';
            difficultySelection.style.display = 'none';
            gameContainer.style.display = 'none';
            winMessage.style.display = 'none';
        });

        changeAvatarButton.addEventListener('click', function() {
            openAvatarStore();
        });

        openPokemonStoreBtn.addEventListener('click', function() {
            openPokemonStore();
        });

        backToMenuButton.addEventListener('click', function() {
            avatarStore.style.display = 'none';
            mainMenu.style.display = 'block';
            updateTotalScore();
        });

        backToMenuPokemonButton.addEventListener('click', function() {
            pokemonStore.style.display = 'none';
            mainMenu.style.display = 'block';
            updateTotalScore();
        });

        pokedexIcon.addEventListener('click', function() {
            openPokedex();
        });

        closePokedexButton.addEventListener('click', function() {
            pokedex.style.display = 'none';
            pokemonStore.style.display = 'block';
        });

        // Inicialización
        window.onload = function() {
            loadGame();
            mainMenu.style.display = 'block';
            difficultySelection.style.display = 'none';
            gameContainer.style.display = 'none';
            winMessage.style.display = 'none';
            avatarStore.style.display = 'none';
            pokemonStore.style.display = 'none';
            pokedex.style.display = 'none';
            updateTotalScore();
            updateAvatar();
        };
    </script>
</body>
</html>
